---
title: 스트림 - 1
date: 2023-02-01
categories: [C++,C++]
tags: [C++]		# TAG는 반드시 소문자로 이루어져야함!
---

스트림
=====================
* 연속적인 데이터의 흐름 혹은 데이터를 전송하는 소프트웨어 모듈
  
* 스트림은 바이트 단위로 입출력한다.
 
* 스트림마다 방향과 소스(출발지) 또는 목적지를 지정할 수 있다.

<br><br>

1 - C++에서 기본으로 정의된 스트림
-----------------------


|스트림|설명|
|-----|---|
|cin|입력 스트림. '입력 콘솔'에 들어온 데이터를 읽는다.|
|cout|버퍼를 사용하는 출력 스트림. 데이터를 '출력 콘솔'에 쓴다.|
|cerr|버퍼를 사용하지 않는 출력 스트림. 데이터를 '에러 콘솔'에 쓴다. 에러 콘솔과 출력 콘솔이 같을 때가 많다.|
|clog|버퍼를 사용하는 err|

<br>

* 버퍼를 사용하는 스트림 : 받은 데이터를 버퍼에 저장했다가 블록 단위로 목적지에 보낸다.
  
* 버퍼를 사용하지 않는 스트림 : 데이터가 들어오자마자 목적지로 보낸다.

* 버퍼에 잠시 저장(버퍼링) 하는 이유는 블록 단위로 묶어서 보내는 것이 효율적이기 때문이다.

* 버퍼를 사용하는 스트림은 버퍼를 깨끗이 비우는 flush() 메서드로 현재 버퍼에 담긴 데이터를 목적지로 보낸다.

<br><br><br><br>

2 - 스트림의 종류
----------------------------
* 스트림은 데이터를 입력받거나 출력하는 객체라면 어떤것에도 적용할 수 있다.
  
* 콘솔,네트워크,파일 스트림, 스트링 스트림 등등 있다.

<br><br><br><br>

출력 스트림
=======================

1 - 출력 스트림의 기초
--------------

* \<ostream> 헤더파일에 정의되어 있다. ( \<iostream> 헤더 안에 있음)

* C++의 기본 타입은 << 연산자로 처리할 수 있다.

* cout 스트림은 C++에서 기본으로 제공하는 내장 스트림으로, 콘솔 (표준 출력)에 값을 쓴다.

<br>

    int j = 11;
    cout << "The value of j is" << j << endl;
    
    // '\n' 은 새 줄(New line)에서 시작
    // endl 은 버퍼를 비우면서 새 줄에서 시작

<br>

  * 스트림은 다음과 같은 조건을 만족할 때 모든 데이터를 내보내고 버퍼를 비운다.

    * 스트림의 버퍼를 비우기 위해 flush()를 호출할 때
  
    * 스트림의 버퍼가 가득 찼을 때
  
    * endl과 같은 경곗값에 도달할 때

    * 스트림이 스코프를 벗어나 소멸될 때

    * 출력 스트림에 대응되는 입력 스트림으로부터 요청이 들어올 때

      * ex) cin으로 입력받으면 cout으로 버퍼를 비움

<br><br><br>

2 - 출력 스트림에서 제공하는 메서드
---------------------------
* put()과 write()

  * 저수준 출력 메서드
  
  * 데이터에 특정한 포맷을 적용하거나 데이터의 내용을 가공하지 않고 전달된 상태 그대로 출력

<br>

    // write
    const char* test = "hello there\n";
    cout.write(test,strlen(test));

    // put
    cout/put('a');

<br>
  
* flush()
  
  * 스트림의 버퍼를 명시적으로 비우는 함수
  
<br>

    cout << "abc";
    cout.flush();   // 콘솔에 abc 출력
    cout << "def";
    cout.flush();   // 콘솔에 def 출력


<br><br><br>

3 - 출력 에러 처리하기
-----------------------------

* 출력 에러가 발생하는 경우는 다양하다.
  
  * 존재하지 않는 파일을 열 때
 
  * 디스크가 꽉 차서 쓰기 연산을 처리할 수 없을 때



* 에러 관련 메서드

  * good() 메서드를 사용해 스트림의 상태 정보를 조회할 수 있는 메서드
  
    * 원인을 알려주지 않기 때문에 bad() 메서드를 사용해야 자세히 볼 수 있다.<br><br>
  
  * bad() 메서드는 에러 원인을 알려주는 메서드
  
    * bad() 메서드가 true를 리턴하면 심각한 에러가 발생했다는 뜻이다.<br><br>

  * fail 메서드는 최근 수행한 연산에 오류가 발생했는지 확인하는 메서드

  * clear 메서드는 스트림의 에러 상태를 초기화 한다.

<br><br>

4 - 출력 매니퓰레이터
---------------------
* C++의 스트림은 단순히 데이터만 전달하는데 그치지 않고, 매니퓰레이터(조종자)라는 객체를 받아<br> 스트림의 동작을 변경할 수 있다.

* endl이 바로 스트림 매니퓰레이터
  * endl은 데이터와 동작을 모두 담고있다.

* 대부분 \<ios>나 \<iomanip> 표준 헤더 파일에 정의돼 있다.

* 유용한 매니퓰레이터
  
  * boolalpha와 noboolalpha : 스트림에 bool값을 true나 false로 출력하거나 1이나 0으로 출력하도록 설정
    * 기본값은 noboolalpha<br><br>
  
  * hex,oct,dec : 각각 숫자를 16진수, 8진수, 10진수로 출력<br><br>
  
  * setprecision : 분숫값을 표현할 때 적용할 소수점 자릿수 지정<br><br>
  
  * setw : 숫자 데이터를 출력할 필드의 너비를 지정<br><br>
  
  * setfill : 지정된 너비보다 숫자가 작을 때 빈 공간을 채울 문자를 지정<br><br>
  
  * showpoint와 noshowpoint : 소수점 아래의 수가 없는 부동소수점수를 스트림에서 표현할 때 소수점의 표시 여부 설정<br><br>
  
  * put_money : 스트림에서 화폐 금액을 일정한 형식에 맞게 표현할 때 사용<br><br>
  
  * put_time : 스트림에서 시간을 일정한 형식에 맞게 표현할 때 사용<br><br>
  
  * quoted: 지정한 스트링을 인용부호(따옴표)로 감싸고, 스트링 안에 있는 인용 부호를 이스케이프로 변환<br><br>

* 위에서 setw을 제외한 나머지 매니퓰레이터들은 한번 설정하고 나면 리셋하기 전까지 출력에 계속 반영된다.

<br><br><br>

입력 스트림
=================

1 - 입력 스트림의 기초
------------------------------
* 입력 스트림으로부터 데이터를 읽는 방법은 두가지가 있다.
  
  * 입력 연산자 >>를 사용한다
  
    * 입력 연산자 >>는 공백을 기준으로 입력된 값을 토큰화 한다.
  
    * 그렇기 때문에 >>를 사용하면 입력에 공백을 사용하지 못한다.
    
  * get()을 이용한다


<br><br><br>

2 - 입력 에러 처리하기
===========================
* 입력 스트림의 에러는 대부분 읽을 데이터가 없을 때 발생한다. 
  
  * 예를들어 스트림의 끝에 도달할 때 등이 있다.

<br>

* 이에 대처하는 흔한 방법은 입력 스트림에 접근하기 전에 조건문으로 스트림의 상태를 확인하는 것
  
<br>

    while (cin) {...}

<br>  

* 출력 스트림과 마찬가지로 입력 스트림에서도 good() , bad(), fail(), eof() 메서드를 호출할 수 있다.

* 아래 코드는 데이터를 읽는 과정에서 발생하는 에러에 대처하기 위해 흔히 사용하는 패턴

<br>


    if(!cin.good())
    {
        cerr << "Standard input is in a bad State" << endl;
        return 1;
    }

    int number;
    while(!cin.bad())
    {
        cin>>number;
        if(cin.good())
          sum+=number;

        else if(cin.eof())
          break;  //파일 끝에 도달

        else if(cin.fail()){  //문제 발생
            cin.clear();      //에러 상태를 제거
            string BadToken;  
            cin >> BadToken;  // 잘못된 입력값을 가져온다.
            cerr << "WARNING : Bad input encounterd:" << BadToken << endl;
        }
    }

<br><br><br>

3 - 입력 메서드
====================
* get()

  * 스트림의 다음 문자를 리턴

  * 스트림 데이터를 저수준으로 읽음

  * get()은 주로 >> 연산자를 사용할 때 자동으로 토큰 단위로 잘리는 문제를 피하기 위해 사용

        string readName(istream& stream)
        {
            string name;
            while(stream)
            {
                int next = stream.get();  // 입력 스트림에서 한문자씩 가져옴
                if(!stream || next == std::char_traits<char>::eof())
                  break;
                name += static_cast<char>(next); // 문자 추가
            }
            return name;
        }
    
    * 위의 함수에서 주목할 점
    1. 매개 변수의 타입이 non-const 레퍼런스. 스트림에서 데이터를 읽는 메서드는 실제 스트림을 변경하기 때문 
    
    2. get()의 리턴값을 char가 아닌 int 타입. get()은 EOF에 해당하는 std::char_traits<char>::eof()를 비롯한 문자가 아닌 특수한 값을 리턴할 수 있기 때문

<br>

* unget()

  * 데이터를 다시 입력 소스 방향으로 보내는 메서드
  
  * unget()을 호출하면 스트림이 한칸 앞으로 거슬러 올라가서 이전에 읽은 문자를 스트림으로 되돌린다.

  * unget() 연산의 성공 여부는 fail() 메서드로 ㅎ확인한다.

<br>

* putback()

  * unget() 메서드와 마찬가지로 입력 스트림을 한 문자만큼 되돌린다
  
  * unget()과 달리 스트림에 되돌릴 문자를 인수로 받는다.

<br>

* peek()

  * get()을 호출할 때 리턴될 값을 미리 보여준다.

<br>

* getline()
  
  * get()과 달리 미리 설정한 버퍼가 가득 채워질 때까지 문자 한 줄을 읽는다.
  
  * 한줄의 끝을 나타내는 \0 (EOF)문자도 버퍼의 크기에 포함한다.


<br><br><br>

4 - 입력 매니퓰레이터
========================
* boolalpha와 noboolalpha
  * boolalpha는 false란 스트링값을 bool 타입인 false로 해석하고 나머지 스트링을 true로 처리<br>
  * noboolalpha는 0을 부울 값으로 false로 해석하고 0이 아닌 나머지값을 true로 처리한다.<br>
  * 기본적으로 noboolalpha로 설정돼 있다.
  
<br>

* hex,oct,dec : 각각 16진수, 8진수, 10진수로 읽도록 지정

<br>

* skipw와 noskipw
  * skipws를 지정하면 토큰화할 떄 공백을 건너뛰고 noskipw를 지정하면 공백을 하나의 토큰으로 지정한다.<br>기본적으로 skipws로 지정돼 있다.

<br>

* ws : 스트림의 현재 위치부터 연달아 나온 공백 문자를 건너뛴다.

<br>

* get_money : 스트림에서 화폐 금액을 표현한 값을 읽는 매개변수 방식의 매니퓰레이터

<br>

* get_time : 스트림에서 일정한 형식으로 표현된 시각정보를 읽는 매개변수 방식의 매니퓰레이터

<br>

* quoted : 인용부호(따옴표)로 묶은 스트링을 읽는ㄴ 매니퓰레이터로서 인수를 받는다.
