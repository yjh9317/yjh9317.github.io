---
title: Rendering_PipeLine
date: 2022-06-07
categories: [DirectX, DirectX]
tags: [directx]		# TAG는 반드시 소문자로 이루어져야함!
---



# DirectX 렌더링 파이프라인 요약

* DirectX 렌더링 파이프라인은 3차원 장면 정보가 화면에 표시될 2차원 이미지로 변환되는 일련의 처리 단계입니다. 각 단계는 GPU 내에서 특정 작업을 수행

* 이러한 단계를 거쳐 3D 모델 데이터는 최종적으로 우리 눈에 보이는 2D 이미지로 렌더링

## 1. IA (Input Assembler) - 입력 조립기 

#### 역할

* 렌더링 파이프라인의 시작점

#### 주요 작업

* CPU로부터 정점(Vertex) 데이터와 인덱스(Index) 데이터를 읽어와 기본 도형(Primitive - 주로 삼각형)으로 조립하고, 이를 다음 단계로 전달

## 2. Vertex Shader (VS) - 정점 셰이더

#### 역할

* 입력된 각 정점(Vertex)에 대해 개별적으로 실행되는 프로그램

#### 주요 작업
* 정점의 위치를 로컬 공간에서 월드 공간, 뷰 공간을 거쳐 최종적으로 NDC(Normalized Device Coordinates, 정규화된 장치 좌표계) 또는 투영 좌표계로 변환
* 정점의 색상, 텍스처 좌표 등 다른 속성들을 계산하거나 변환할 수도 있음

## 3. Tessellation Stages (Hull Shader & Domain Shader) - 테셀레이션 단계 (선택)

#### 역할 (DirectX 11에서 도입) 

* 모델의 표면을 더 세밀하게 나누어 디테일을 동적으로 추가

#### 주요 작업

* `Hull Shader`: 입력된 기본 도형(패치)을 어떻게 세분화할지 결정하고 제어점을 출력
* `Domain Shader`: Hull Shader에서 생성된 정보를 바탕으로 실제 정점들을 생성하여 표면을 더 잘게 나눔
* `LOD(Level of Detail)` 구현에 유용합니다.

## 4. Geometry Shader (GS) - 기하 셰이더 (선택)

#### 역할 (DirectX 10에서 도입) 

* 파이프라인 중간에서 기본 도형(Primitive) 전체를 입력으로 받아 새로운 기본 도형을 생성하거나 기존 도형을 수정, 또는 제거할 수 있음

#### 주요 작업

* 하나의 정점, 선, 삼각형을 입력받아 0개 이상의 기본 도형을 출력할 수 있음
* 파티클 생성, 실루엣 확장 등에 사용될 수 있지만, 과도하게 사용하면 성능에 부담을 줄 수 있음


## 5. Rasterizer (RS) - 래스터라이저

#### 역할
* 벡터 기반의 기본 도형(주로 삼각형)을 화면에 표시될 픽셀 단위로 변환

#### 주요 작업

* `Culling (컬링)`: 화면에 보이지 않을 삼각형을 미리 제거. 주로 삼각형 정점의 감긴 순서(winding order)를 기준으로 앞면인지 뒷면인지 판별하여 뒷면 컬링(back-face culling)을 수행

* `뷰포트 변환 및 클리핑`: NDC 좌표를 화면 좌표로 변환하고, 화면 영역을 벗어나는 부분을 잘라냄

* `픽셀 생성`: 각 삼각형이 덮고 있는 픽셀들을 결정

* `속성 보간`: 정점 셰이더에서 계산된 정점 속성(색상, 텍스처 좌표 등)을 각 픽셀에 맞게 보간. 이 보간된 값들이 픽셀 셰이더의 입력으로 됨

## 6. Pixel Shader (PS) - 픽셀 셰이더 (Fragment Shader라고도 함)

#### 역할

* 래스터라이저 단계에서 생성된 각 픽셀(후보)에 대해 실행되는 프로그램

#### 주요 작업

* 픽셀의 최종 색상을 계산. 텍스처 샘플링, 조명 계산, 그림자 적용 등 복잡한 연산이 수행
* 픽셀의 깊이 값(Z-value)을 계산할 수도 있음

## 7. OM (Output Merger) - 출력 병합기

#### 역할

* 픽셀 셰이더에서 계산된 픽셀 값들을 최종적으로 화면에 표시될 렌더 타겟(보통 백 버퍼)에 기록하는 단계

#### 주요 작업

* `Depth Stencil Test (깊이/스텐실 검사)`:
깊이 검사 (Z-Test): 현재 픽셀의 깊이 값과 깊이 버퍼(Depth Buffer)에 저장된 값을 비교하여, 현재 픽셀이 다른 픽셀에 가려지는지 판정
  *  가려진 픽셀은 렌더 타겟에 기록되지 않습니다 (오클루전 처리).

* `스텐실 검사`: 스텐실 버퍼를 사용하여 특정 영역에만 렌더링하는 등의 고급 효과를 구현

* `Blending (블렌딩)`:
픽셀 셰이더에서 나온 픽셀 색상과 렌더 타겟에 이미 있는 픽셀 색상을 특정 혼합 공식에 따라 섞음.
  * 투명/반투명 효과 등을 구현하는 데 사용
  
      
  
    
그림
================
출처:https://docs.microsoft.com/ko-kr/windows/win32/direct3d11/overviews-direct3d-11-graphics-pipeline

<img src="../../assets/img/PipeLine.jpg">