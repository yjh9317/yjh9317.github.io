<!DOCTYPE html><html lang="ko" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="템플릿 형식 연역(template type deduction)을 이해하자" /><meta property="og:locale" content="ko" /><meta name="description" content="C++ 템플릿은 강력한 기능으로, auto 키워드도 템플릿 형식 연역을 기반으로 작동한다." /><meta property="og:description" content="C++ 템플릿은 강력한 기능으로, auto 키워드도 템플릿 형식 연역을 기반으로 작동한다." /><link rel="canonical" href="https://yjh9317.github.io/posts/1.Understand-template-type-deduction/" /><meta property="og:url" content="https://yjh9317.github.io/posts/1.Understand-template-type-deduction/" /><meta property="og:site_name" content="yjh9317" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-15T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="템플릿 형식 연역(template type deduction)을 이해하자" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-04-01T15:01:32+09:00","datePublished":"2024-01-15T00:00:00+09:00","description":"C++ 템플릿은 강력한 기능으로, auto 키워드도 템플릿 형식 연역을 기반으로 작동한다.","headline":"템플릿 형식 연역(template type deduction)을 이해하자","mainEntityOfPage":{"@type":"WebPage","@id":"https://yjh9317.github.io/posts/1.Understand-template-type-deduction/"},"url":"https://yjh9317.github.io/posts/1.Understand-template-type-deduction/"}</script><title>템플릿 형식 연역(template type deduction)을 이해하자 | yjh9317</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="yjh9317"><meta name="application-name" content="yjh9317"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">yjh9317</a></div><div class="site-subtitle font-italic">코딩열심히하려는사람</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yjh9317" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>템플릿 형식 연역(template type deduction)을 이해하자</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>템플릿 형식 연역(template type deduction)을 이해하자</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1705244400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 15, 2024 </em> </span> <span> Updated <em class="" data-ts="1711951292" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 1, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Yang jeong hyeon</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2227 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><ul><li><p>C++ 템플릿은 강력한 기능으로, <code class="language-plaintext highlighter-rouge">auto 키워드도 템플릿 형식 연역을 기반으로 작동한다.</code></p><ul><li>하지만 auto는 템플릿에 비해 직관성이 좋지는 않다.</ul></ul><p><br /></p><h1 id="템플릿-작동-방식"><strong>템플릿 작동 방식</strong></h1><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1">// 템플릿</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="n">ParamType</span> <span class="n">param</span><span class="p">);</span>

<span class="c1">// 호출</span>
<span class="n">f</span><span class="p">(</span><span class="n">expr</span><span class="p">);</span> <span class="c1">// expr로부터 T와 ParamType을 연역 </span>
</pre></table></code></div></div><ul><li><p>컴파일러는 expr을 이용하여 두 가지 형식을 연역한다.</p><ul><li><p>하나는 <code class="language-plaintext highlighter-rouge">T에 대한 형식</code>이고 다른 하나는 <code class="language-plaintext highlighter-rouge">ParamType에 대한 형식</code>이다</p><li><p>이 두 형식이 다른 경우가 많은데 ParamType에 흔히 const나 &amp;, &amp;&amp;가 붙는 경우가 많아서이다.</p></ul></ul><p><br /></p><h1 id="t에-대한-형식">T에 대한 형식</h1><ul><li><p>T에 대한 형식은 위에서 함수에 전달된 인수인 expr의 타입과 같을거라고 예상되지만, 항상 그런것은 아니다</p><li><p><code class="language-plaintext highlighter-rouge">T에 대한 형식은 expr의 형식뿐만 아니라, ParamType의 형태에도 의존한다</code></p></ul><h3 id="paramtype이-포인터-or-참조-형식이지만-보편-참조는-아닐-경우"><span class="mr-2">ParamType이 포인터 Or 참조 형식이지만 보편 참조는 아닐 경우</span><a href="#paramtype이-포인터-or-참조-형식이지만-보편-참조는-아닐-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>이 경우 다음과 같이 진행된다.</p><ol><li><p>만일 expr이 참조 형식이면 참조 부분을 무시한다.</p><li><p>그런 다음 expr의 형식을 ParamType에 대해 대응하여 T의 형식을 결정한다.</p></ol></ul><h4 id="t"><span class="mr-2"><strong>T&amp;</strong></span><a href="#t" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">param</span><span class="p">)</span>  <span class="c1">//param은 &amp;</span>

<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>         <span class="c1">// int</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>   <span class="c1">// const int</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>  <span class="c1">// const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>   <span class="c1">// T는 int,</span>
        <span class="c1">// param의 형식은 int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="p">);</span>  <span class="c1">// T는 const int, </span>
        <span class="c1">// param의 형식은 const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">rx</span><span class="p">);</span>  <span class="c1">// T는 const int,</span>
        <span class="c1">// param의 형식은 const int&amp;</span>
</pre></table></code></div></div><ul><li><p>주목할 점</p><ul><li><p>cx와 rx는 const여서 T가 const int로 연역되었다.</p><li><p>rx는 참조지만 T는 비참조로 연역되었다. 이유는 <code class="language-plaintext highlighter-rouge">참조성이 무시되기 때문</code></p></ul></ul><h4 id="const-t"><span class="mr-2"><strong>const T&amp;</strong></span><a href="#const-t" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">param</span><span class="p">)</span>  <span class="c1">//param은 const &amp;</span>

<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>         <span class="c1">// int</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>   <span class="c1">// const int</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>  <span class="c1">// const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>   <span class="c1">// T는 int,</span>
        <span class="c1">// param의 형식은 const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="p">);</span>  <span class="c1">// T는 const int, </span>
        <span class="c1">// param의 형식은 const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">rx</span><span class="p">);</span>  <span class="c1">// T는 const int,</span>
        <span class="c1">// param의 형식은 const int&amp;</span>
</pre></table></code></div></div><ul><li><p>주목할 점</p><ul><li>T&amp;와 다른 점은 param이 const에 대한 참조로 간주되어, const가 T로 일부로 연역될 필요는 없다.</ul></ul><h4 id="t-1"><span class="mr-2"><strong>T*</strong></span><a href="#t-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">param</span><span class="p">)</span>  <span class="c1">//param은 포인터</span>

<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>         <span class="c1">// int</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">*</span> <span class="n">px</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">;</span>   <span class="c1">// const *</span>

<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>   <span class="c1">// T는 int,</span>
        <span class="c1">// param의 형식은 int*</span>

<span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="p">);</span>  <span class="c1">// T는 const int, </span>
        <span class="c1">// param의 형식은 const int*</span>
</pre></table></code></div></div><ul><li><p>주목할 점</p><ul><li>param이 참조가 아니라 포인터라도 형식 연역은 본질적으로 같은 방식으로 진행된다.</ul></ul><p><br /></p><h3 id="paramtype이-보편-참조일-경우"><span class="mr-2"><strong>ParamType이 보편 참조일 경우</strong></span><a href="#paramtype이-보편-참조일-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>보편 참조 매개변수를 받는 경우, 왼값인지 오른값인지에 따라 달라진다.</p><li><p><code class="language-plaintext highlighter-rouge">왼값이라면, T와 ParamType 둘 다 왼값 참조로 연역된다</code></p><ul><li>템플릿 형식 연역에서 T가 참조 형식으로 연역되는 경우는 이것이 유일하다.<li>ParamType의 선언 구문은 오른값 참조와 같은 모습이지만, 연역된 형식은 왼값 참조다.</ul><li><p><code class="language-plaintext highlighter-rouge">오른값이면 정상적인 (첫 번째 경우) 규칙들로 적용된다.</code></p></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;&amp;</span> <span class="n">param</span><span class="p">)</span>  <span class="c1">//param은 보편 참조</span>

<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>         <span class="c1">// int</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>   <span class="c1">// const int</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>  <span class="c1">// const int&amp;</span>

<span class="c1">// 왼값</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>   <span class="c1">// T는 int&amp;,</span>
        <span class="c1">// param의 형식은 int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="p">);</span>  <span class="c1">// T는 const int&amp;, </span>
        <span class="c1">// param의 형식은 const int&amp;</span>

<span class="n">f</span><span class="p">(</span><span class="n">rx</span><span class="p">);</span>  <span class="c1">// T는 const int&amp;,</span>
        <span class="c1">// param의 형식은 const int&amp;</span>

<span class="c1">// 오른값</span>
<span class="n">f</span><span class="p">(</span><span class="mi">27</span><span class="p">);</span>  <span class="c1">// T는 int,</span>
        <span class="c1">// param의 형식은 int&amp;&amp;</span>
</pre></table></code></div></div><ul><li><p>각 해당 형식으로 연역되는 구체적인 이유는 항목24에 기술하겠다.</p><li><p>여기서는 왼값 참조나 오른값 참조 매개변수들에 대한 규칙들과는 다르다라는 점만 기억하자.</p></ul><p><br /></p><h3 id="paramtype이-포인터도-아니고-참조도-아닌-경우"><span class="mr-2"><strong>ParamType이 포인터도 아니고 참조도 아닌 경우</strong></span><a href="#paramtype이-포인터도-아니고-참조도-아닌-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>이 경우는 함수가 값으로 전달(pass-by-value)되는 상황이다.</ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="n">T</span> <span class="n">param</span><span class="p">);</span>
</pre></table></code></div></div><ul><li><p>param은 인수의 복사본, 즉 새로운 객체이기 때문에 expr에서 T가 연역되는 과정에서 다음과 같은 규칙이 적용된다.</p><ol><li>이전처럼, 만일 expr의 형식이 참조면, 참조 부분은 무시된다.<li>expr의 참조성을 무시한 후, expr이 const면 const 역시 무시한다.<li>volatile도 무시한다.</ol></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>         <span class="c1">// int</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>   <span class="c1">// const int</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rx</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>  <span class="c1">// const int&amp;</span>

<span class="c1">// 왼값</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>   <span class="c1">// T와 param 둘 다 int</span>

<span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="p">);</span>  <span class="c1">// T와 param 둘 다 int</span>

<span class="n">f</span><span class="p">(</span><span class="n">rx</span><span class="p">);</span>  <span class="c1">// T와 param 둘 다 int</span>
</pre></table></code></div></div><p><br /></p><ul><li><p>param은 복사본이므로 cx와 rx의 const와는 무관하고 const가 무시되는 이유가 바로 이것이다.</p><li><p>명심할 점은 const나 volatile이 값 전달 매개변수에 대해서만 무시한다는 것이다.</p><li><p>const에 대한 참조나 포인터인 매개변수의 경우, expr의 const성이 보존된다.</p></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="n">T</span> <span class="n">param</span><span class="p">);</span>

<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">ptr</span> <span class="o">=</span> <span class="s">"ABC"</span> <span class="c1">// ptr은 const 객체를 가리키는 const 포인터</span>

<span class="n">f</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
</pre></table></code></div></div><ul><li><p>위의 경우, ptr 왼쪽에 있는 const때문에 ptr의 주소 자체는 const가 된다.</p><li><p>ptr를 f에 전달하면 그 포인터를 구성하는 비트들이 param에 복사된다.<br /> 즉,포인터 자체는 값으로 전달된다.</p><li><p>값 전달 방식이기 때문에 param은 const char*의 형태로 연역된다.</p><li><p>ptr가 가리키는 것의 const성은 보존되나, ptr 자체의 const 성은 ptr를 복사해서 새 포인터 param을 생성하는 도중에 사라진다.</p></ul><p><br /></p><h1 id="배열-인수"><strong>배열 인수</strong></h1><ul><li><p>배열 형식과 포인터는 비슷해 보이지만, 다르다</p><li><p>배열과 포인터를 바꿔서 사용할 수 있는 이유는 <code class="language-plaintext highlighter-rouge">배열이 배열의 첫 원소를 가리키는 포인터로 붕괴(decay)한다라는 점</code>에서 비롯된다.</p></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 형식은 const char[2]</span>
<span class="k">const</span> <span class="kt">char</span> <span class="n">name</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"Hi"</span><span class="p">;</span>

<span class="c1">// 배열(name)이 포인터로 붕괴</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ptrToName</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
</pre></table></code></div></div><ul><li><p>그런데 값 전달 매개변수를 받는 템플릿으로 전달되면 어떻게 될까?</p><ul><li>우선, 배열 형식의 함수 매개변수는 없기 때문에 만들 수 없다.</ul></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">myFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">Param</span><span class="p">[]);</span>
<span class="kt">void</span> <span class="nf">myFunc</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">Param</span><span class="p">);</span>
</pre></table></code></div></div><ul><li><p>템플릿에 넣기 전에, 위처럼 <code class="language-plaintext highlighter-rouge">배열 매개변수와 포인터 매개변수의 동치성은 C에서 부터 이어져 왔다</code></p><li><p>그래서 이러한 아래와 같이 전달되는 배열 형식은 포인터 형식으로 연역된다.</p></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="n">T</span> <span class="n">Param</span><span class="p">);</span>

<span class="n">f</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>  <span class="c1">// 배열이지만 T는 const char*로 연역</span>
</pre></table></code></div></div><ul><li>여기서 한가지 요령이 있는데, <code class="language-plaintext highlighter-rouge">함수의 매개변수를 배열로 선언할 순 없지만 배열에 대한 참조로 선언할 수 있다.</code></ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">Param</span><span class="p">);</span>

<span class="n">f</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>  <span class="c1">// 참조되어 T는 const char[2]로 연역</span>
</pre></table></code></div></div><ul><li>이러한 점을 이용하면 다음과 같은 경우도 가능하다.</ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">// 배열의 크기를 컴파일 시점 상수로서 돌려주는 템플릿 함수</span>
<span class="c1">// constexpr로 사용하여 함수 호출 결과를 컴파일 도중에 사용 가능</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">N</span><span class="p">&gt;</span>
<span class="k">constexpr</span> <span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">arraySize</span><span class="p">(</span><span class="n">T</span> <span class="p">(</span><span class="o">&amp;</span><span class="p">)[</span><span class="n">N</span><span class="p">])</span> <span class="k">noexcept</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">N</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// 원소 개수 3</span>
  <span class="kt">int</span> <span class="n">keyVals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">};</span>

  <span class="c1">// 원소 개수 3</span>
  <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">arraySize</span><span class="p">(</span><span class="n">keyVals</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">mappedVals</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h1 id="함수-인수"><strong>함수 인수</strong></h1><ul><li>배열뿐만 아닌, 배열에 대한 형식 연역처럼 함수와 함수포인터도 적용된다.</ul><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">someFunc</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">double</span><span class="p">);</span> <span class="c1">// void(int, double)</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f1</span><span class="p">(</span><span class="n">T</span> <span class="n">Param</span><span class="p">);</span>   <span class="c1">// 값 전달</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">f2</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">Param</span><span class="p">);</span>  <span class="c1">// 참조 전달</span>

<span class="c1">// 함수포인터로 연역됨</span>
<span class="n">f1</span><span class="p">(</span><span class="n">someFunc</span><span class="p">);</span>  <span class="c1">// void(*)(int,double)</span>

<span class="c1">// 함수 참조로 연역됨</span>
<span class="n">f2</span><span class="p">(</span><span class="n">someFunc</span><span class="p">);</span>  <span class="c1">// void(&amp;)(int,double)</span>
</pre></table></code></div></div><h1 id="결론"><strong>결론</strong></h1><blockquote><p>이것만은 잊지 말자!</p><ul class="prompt-tip"><li><p>템플릿 형식 연역 도중 참조 형식의 인수는 비참조로 취급. 즉, 참조성 무시</p><li><p>보편 참조 매개변수에 대한 형식 연역 과정에서 왼값 인수는 특별 취급</p><li><p>값 전달 방식 매개변수에 대한 형식 연역 과정에서 const 또는 volatile 인수는 non-const, non-volatile로 취급</p><li><p>템플릿 형식 연역 과정에서 배열이나 함수 이름에 해당하는 인수는 포인터로 붕괴. <br /> 단, 그런 인수가 참조를 초기화하는데 쓰이면 포인터로 붕괴하지 않음.</p></ul></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/modern-effective-c/'>Modern Effective C++</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/modern-effective-c/" class="post-tag no-text-decoration" >modern effective c++</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%ED%85%9C%ED%94%8C%EB%A6%BF+%ED%98%95%EC%8B%9D+%EC%97%B0%EC%97%AD%28template+type+deduction%29%EC%9D%84+%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90+-+yjh9317&url=https%3A%2F%2Fyjh9317.github.io%2Fposts%2F1.Understand-template-type-deduction%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%ED%85%9C%ED%94%8C%EB%A6%BF+%ED%98%95%EC%8B%9D+%EC%97%B0%EC%97%AD%28template+type+deduction%29%EC%9D%84+%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90+-+yjh9317&u=https%3A%2F%2Fyjh9317.github.io%2Fposts%2F1.Understand-template-type-deduction%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyjh9317.github.io%2Fposts%2F1.Understand-template-type-deduction%2F&text=%ED%85%9C%ED%94%8C%EB%A6%BF+%ED%98%95%EC%8B%9D+%EC%97%B0%EC%97%AD%28template+type+deduction%29%EC%9D%84+%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90+-+yjh9317" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Gameplay-Param/">GameplayTag Param</a><li><a href="/posts/Device/">Device</a><li><a href="/posts/SwapChain/">SwapChain</a><li><a href="/posts/VertexBuffer/">VertexBuffer</a><li><a href="/posts/IndexBuffer/">IndexBuffer</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/unreal/">unreal</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/design-pattern/">design pattern</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/directx/">directx</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/data-structure/">data_structure</a> <a class="post-tag" href="/tags/modern-effective-c/">modern effective c++</a> <a class="post-tag" href="/tags/directx3d/">directx3d</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/2.Understand-auto-type-deduction/"><div class="card-body"> <em class="small" data-ts="1705503600" data-df="ll" > Jan 18, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>auto의 형식 연역 규칙을 숙지하라</h3><div class="text-muted small"><p> auto와 템플릿 auto 형식은 한가지 예외만 빼면 템플릿과 똑같이 작동한다. auto 형식 연역과 템플릿 형식 연역 사이에는 직접적인 대응 관계가 존재한다. 1 2 3 4 5 // 템플릿 template&amp;lt;typename T&amp;gt; void f(ParamType param); f(expr); ...</p></div></div></a></div><div class="card"> <a href="/posts/3.Understand-decltype/"><div class="card-body"> <em class="small" data-ts="1705762800" data-df="ll" > Jan 21, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>decltype의 작동 방식을 숙지하라</h3><div class="text-muted small"><p> decltype은 주어진 이름이나 표현식의 형식을 알려주는 키워드 하지만 가끔 예상밖의 결과를 제공 대부분의 경우 템플릿과 auto와 달리 decltype은 그대로의 결과를 도출한다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 const int i ...</p></div></div></a></div><div class="card"> <a href="/posts/4.Know-how-to-view-deduced-types/"><div class="card-body"> <em class="small" data-ts="1706022000" data-df="ll" > Jan 24, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>연역된 형식을 파악하는 방법을 알아두라.</h3><div class="text-muted small"><p> 형식 연역 결과를 직접 확인하는 수단은 필요한 시점에 따라 다르다. 이번 항목에선 3가지 시점으로 살펴본다. IDE 편집기 IDE 코드 편집기는 프로그램 개체(변수,매개변수,함수 등)을 마우스 커서에 올리면 개채 형식을 표현해준다. 이런 일이 가능하려면 코드가 어느정도 컴파일 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EB%AC%B8%EC%9E%90%EC%97%B4/" class="btn btn-outline-primary" prompt="Older"><p>문자열</p></a> <a href="/posts/DISTINCT-&&-ORDERED-BY-&&-LIMIT/" class="btn btn-outline-primary" prompt="Newer"><p>DISTINCT && ORDERED BY && LIMIT && LIKE</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">Yang jeong hyeon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/unreal/">unreal</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/design-pattern/">design pattern</a> <a class="post-tag" href="/tags/coding-test/">coding test</a> <a class="post-tag" href="/tags/directx/">directx</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/data-structure/">data_structure</a> <a class="post-tag" href="/tags/modern-effective-c/">modern effective c++</a> <a class="post-tag" href="/tags/directx3d/">directx3d</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
